## 운영체제와 컴퓨터

운영체제란 하드웨어와 소프트웨어(사용자프로그램을 포함한)가 서로 교류할 수 있도록하는 인터페이스 역할한다.
<br>
<br>

운영체제의 역할은 크게 4가지 있다.

- cpu 스케쥴링과 프로세스 관리
- 메모리 관리
- 디스크 파일 관리
- I/O 디바이스 관리

<br>
<br>

>시스템콜

운영체제가 커널에 접근하기 위한 인터페이스 이며, 사용자 프로세스가 운영체제의 서비스를 받기 위해 커널 함수를 요청할 때 사용된다.

예를 들어 하나의 프로세스가 cpu제어권을 가지고서 수행을 하다가 I/O작업을 해야한다면, 시스템콜을 통해서 cpu제어권을 운영체제에 넘기게 되고, 운영체제는 cpu제어권을 가지고 프로세스의 I/O 요청을 수행한다. 사용자 프로세스는 I/O작업을 요청할 수 없다. 운영체제만 가능한 일이므로, cpu제어권을 운영체제에 넘기고, 요청에 대한 응답이 올때 까지 기다린다.

<br>
<br>

>modebit

cpu제어권은 사용자프로세스 또는 운영체제에 있을 수 있다.
이때 그 구분을 할 수 있는 방법이 modebit이다.
cpu제어권이 사용자프로세스에 있다면 1, 운영체제에 있다면 0이된다.
이를 통해 유저모드인지 커널모드인지 판단을 할 수 있다.
modebit이 0인 경우만 I/O작업을 할 수 있다.

<br>
<br>
<br>
<br>

### 컴퓨터의 요소
CPU, DMA컨트롤러, 타이머, 디바이스컨트롤러, 메모리 등이 있다.
<br>
<br>


>cpu

cpu는 실제 일을 하는 일꾼에 해당한다. cpu에는 산술논리연산장치, 제어창치, 레지스터로 구성되어 있다.
산술논리연산장치는 실제로 논리적 연산을 하는 부분에 해당한다.
제어장치는 입출력 장치간 통신을 제어하고, 데이터처리를 위한 순서를 결정한다.
레지스터는 cpu안의 또다른 임시기억장치로 연산속도가 매우 빠르다. cpu는 자체적으로 데이터를 저장할 방법이 없기 때문에 레지스터를 거쳐 데이터를 전달한다.

cpu의 레지스터에는 프로그램카운터 레지스터라는 것이 존재해서 cpu에 프로세스가 올라 갔을때 어디 까지 실행되었는지 알수 있는 주소를 알고 있다. 그렇기 때문에 cpu제어권이 다시 얻을 경우 맨처음 부터 실행하는 것이 아닌 프로그램카운터 레지스터가 가르키는 다음 주소부터 프로그램이 실행 될 수 있는 것이다.


<br>
<br>

> 인터럽트

인터럽트는 간단히 말해 방해를 의미한다. cpu에 인터럽트를 걸면 cpu는 잠시 하던 일을 멈추게 된다. cpu제어권은 한번 넘어가게 되면 강제적으로 빼았아 오기 전까지 프로세스로 부터 빼았을 수 없다. 그렇다 보니다. 하나의 프로세스가 오래 cpu제어권을 가지게 되면 뒤에 있는 다른 프로세스가 일을 할 수 없게 되고, 이런 문제를 해결하는 방법 중 하나가 인터럽트이다. 

앞서 I/O작업은 운영체제에 의해서 수행된다고 설명했다. 그렇기 때문에 시스템콜을 통해 운영체제에 cpu제어권이 넘어가고, I/O작업을 요청하고, 기다리게 된다. I/O작업이 모두 끝나게 되면, 디바이스 컨트롤러가 cpu에 인터럽트를 걸게 된다.
cpu는 하나의 사이클(수행단위)를 마친 후 인터럽트가 있는지 확인을 한다. 그리고 인터럽트가 있다면, cpu제어권을 운영체제에 넘기게 되고, 운영체제가 다시 cpu를 할당하게 된다.

인터럽트에는 하드웨어인터럽트와 소프트웨어 인터럽트가 있다.
I/O작업의 경우 하드웨어 인터럽트에 해당한다. 앞서 설명한 시스템콜의 경우는 소프트웨어 인터럽트 이며, 이외의 프로세스 오류등이 소프트웨어 인터럽트에 해당한다. 소프트웨어 인터럽트는 또 다른 말로 트랩이라고 한다.


<br>
<br>


> DMA컨트롤러

DMA컨트롤러는 I/O디바이스가 직접 메모리에 접근할 수 있도록 하는 하드웨어 장치이다. I/O작업을 요청하고 작업이 끝나면 cpu에 인터럽트를 건다고 했다. 하지만 I/O작업은 수시로 일어나게 되고, 그렇게 되면 계속해서 인터럽트를 걸게 된다. 이는 cpu가 제대로 작업을 할 수 없게 되는 것이다. 그렇기 때문에 너무 많은 인터럽트를 분산하는 방법으로 DMA컨트롤러가 있다.

<br>
<br>


> 메모리

cpu가 일을 하는 일꾼이라면 메모리는 작업장에 해당한다. cpu는 메모리에 올라와 있는 일을 처리할 뿐이다. 메모리에서 인스트럭션을 읽어와 작업을 처리하게 된다.
cpu의 프로그램카운터 레지스터가 다음 위치를 가르킨다고 했는데, 메모리에 있는 다음 위치를 가르키는 것이다.


<br>
<br>


> 타이머

cpu제어권을 한번 가지게 되면 강제적으로 빼앗기 전까지 다시 찾을 수 없다. 그런 문제를 해결하는 방법으로 타이머를 세팅하게 된다. 타이머를 통해서 일정 시간이 지나게 되면, 더이상 프로세스가 cpu제어권을 가지지 못하고 다시 넘겨주게 된다.
이는 타이머가 인터럽트를 걸면서 cpu제어권이 넘어가게 되는 것이다.

<br>
<br>

> 디바이스 컨트롤러

컴퓨터 자체에 cpu가 있다면, 하나의 디바이스(마우스, 키보드, 모니터, 프린터 등)에는 디바이스 별로 cpu와 비슷한 역할을 하는 디바이스 컨트롤러가 있다. 디바이스 컨트롤러에서는 들어온 요청에 대해서 어떻게 처리를 할지를 결정하며, 작업이 끝난 요청에 대해서는 인터럽트를 걸어주게 된다.
