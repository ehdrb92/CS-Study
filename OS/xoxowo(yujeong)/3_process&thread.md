## 프로세스와 스레드
    프로세스 : 컴퓨터에서 실행되고 있는 프로그램 의미, CPU 스케줄링의 대상이 되는 작업(task) 용어와 거의 같은 의미 
    스레드 : 프로세스 내 작업의 흐름 지칭

### 프로세스와 컴파일 과정
    프로세스는 프로그램으로 부터 인스턴스화 된 것을 말한다.
    예를들면 게임 프로그램과 같은 게임 실행 파일을 실행하면 게임의 프로세스가 시작되는 것.

    프로그램은 컴파일러가 컴파일 과정을 거쳐 컴퓨터가 이해할 수 있는 언어로 번역되어 실행가능한 파일이 되는 것을 의미한다.


### 프로세스의 상태
    프로세스는 여러가지 상태 값을 갖는다.

<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Process_states.svg/1280px-Process_states.svg.png">

#### 생성 상태
    프로세스가 생성된 상태를 의미. fork() 또는 exec() 함수를 통해 생성. 이때 PCB가 할당된다.

* fork() : 부모 프로세스의 주소 공간을 그대로 복사하여, 새로운 자식 프로세스를 생성하는 함수 (주소 공간만 복사하며 부모 프로세스의 비동기 작업 등을 상속하지 않는다.)
* exec() : 새로 프로세스를 생성하는 함수를 의미

#### 대기 상태
    메모리 공간이 충분하면 메모리를 할당받으며, 아닐 경우 대기하며 CPU스케줄러로부터 기다리는 상태

#### 대기 중단 상태
    메모리 부족으로 일시 중단 상태

#### 실행 상태
    CPU 소유권과 메모리를 할당 받아 인스트럭션을 수행중인 상태 (≒ CPU burst가 일어났다고도 표현)

#### 중단 상태
    어떤 이벤트 발생한 이후 기다리며 프로세스가 차단된 상태
    예를 들면 어떤 작업 버튼을 눌렀을 때 잠깐 멈춘 듯한 상태

#### 일시 중단 상태
    대기 중단 상태와 유사하지만, 중단 상태에서 프로세스가 실행되려했지만 메모리 부족으로 일시 중단된 상태

#### 종료 상태
    CPU 소유권과 메모리를 모두 놓고가는 상태. 자연스럽게 종료될 경우도 있지만 비자발적으로 종료되는 경우도 있다.



### 프로세스의 메모리 구조
    운영체제는 프로세스에 적절한 메모리를 할당하는데 **스택**, **힙**, **데이터영역**, **코드영역**으로 나눠진다.
    스택은 위 주소부터 할당되고, 힙은 아래 주소부터 할당된다.

<img src="https://images.velog.io/images/moon-yerim/post/38d6fc92-c342-4a19-baf5-9aa148ae70ca/image.png">

#### 스택 (Stack)
    지역변수, 매개변수, 함수가 저장되고 컴파일 시에 크키가 결정되며 **동적**인 특징을 갖는다.

    스택 영역은 함수가 함수를 재귀적으로 호출하면서 크키가 늘어날 수 있는데 이때 힙과 스택의 메모리 영역을 침범하면 안되기 때문에 힙과 스택 사이의 공간을 비워놓는다.

#### 힙 (Heap)
    동적 할당할 때 사용되며 런타임시 크기가 결정된다. **동적**인 특징을 가짐

#### 데이터 영역 (Data segment, BSS segment)
    데이터 영역은 전역변수, 정적변수가 저장되며 **정적**인 특징을 갖는 프로그램이 종료되면 사라지는 변수가 들어있는 영역이며, BSS영역과 Data영역으로 나뉜다.

#### 코드 영역 (Code segment)
    프로그램에 내장된 소스 코드가 들어가있는 영역으로 수정 불가능한 기계어로 저장되어 **정적**인 특징을 가진다.

### PCB (Process Control Block)
    운영체제가 프로세스 실행을 제어하기 위해 프로세스 정보가 필요한데 이 프로세스 정보는 *메타 데이터를 저장한 '데이터'인 프로세스 제어 블록이 가지고 있다.

    즉, 프로세스를 관리하기 위해 유지되는 데이터 블록이다. 

    프로세스가 생성될 때 프로세스 제어 블록이 만들어지며, 프로세스의 실행이 종료되면 블록도 같이 삭제된다.

* 메타 데이터 : 데이터에 관한 구조화된 데이터이며 데이터를 설명하는 작은 데이터

#### PCB의 구조
<img src="https://woovictory.github.io/img/PCB_os.png">

### 멀티프로세싱
    멀티프로세스를 통해 동시에 두 가지 이상의 일을 수행할 수 있는것을 말한다.
    기존 하나씩 처리하던 프로세스와는 다르게 하나 이상의 일을 병렬로 처리할 수 있어 특정 프로세스의 메모리, 프로세스 중 일부에 문제가 발생해도 다른 프로세스를 이용해 처리할 수 있어 신뢰성이 높다는 강점을 가진다.

### 스레드와 멀티스레딩

#### 스레드
    프로세스의 실행 가능한 가장 작은 단위가 스레드이고, 
    
#### 멀티스레딩     
    프로세스 내 작업을 여러개의 스레드로 작업하는 기법을 멀티스레딩이라고 한다.
    이 멀티스레딩은 스레드끼리 서로 자원을 공유하기 때문에 효율성이 높다.
    단점은 한 스레드에 문제가 생기면 다른 스레드에 영향을 미쳐 프로세스에 영향을 줄 수 있다.

### 공유 자원과 임계 영역    

#### 공유자원(shared resource)
    시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 의미한다. 
    공유 자원을 두개 이상의 프로세스가 동시에 읽거나 쓰는 상황을 경쟁상태라 한다.
    동시에 접근을 시도할 때 접근의 타이밍이나 순서 등이 결과값에 영향을 줄 수 있다. (예상한 결과값이 아닐 수 있음)

#### 임계 영역(critical section)
    둘 이상의 프로세스, 스레드가 공유 자원에 접근할 때 순서 등의 이유로 결과가 달라지는 코드영역을 말한다. 
    임계 영역을 해결하기 위해 *뮤텍스, *세마포어, *모니터가 있으며 상호 배제, 한정 대기, 융통성이란 조건을 만족한다. 
    이러한 방법의 토대가 되는 매커니즘은 lock으로 lock은 프로세스나 스레드가 먼저 실행되고 다른 프로세스나 스레드의 접근을 막는 방법이다.

* 뮤텍스 : 공유 자원을 사용하기 전에 설정하고 사용한 후 해제하는 잠금(하나의 상태만 가짐). 잠그면 다른 스레드가 접근 할 수 없다.
* 세마포어 : 신호를 기반으로 상호배제가 일어나는 신호 메커니즘. 바이너리 세마포어와 카운팅 세마포어가 있다.
* 바이너리 세마포어 : 0과 1 두가지 값만 가질 수 있는 세마포어.
* 카운팅 세마포어 : 여러개의 값을 가질 수 있는 세마포어. 여러 자원에 접근을 제어하는데 사용.
* 모니터 : 둘 이상의 스레드나 프로세스가 공유자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대해 인터페이스만 제공하는 것    

### 교착 상태(deadlock)
    두 개 이상의 프로세스들이 서로가 가진 자원을 기다리며 중단된 상태를 말한다.

#### 교착 상태의 원인
* 상호 배제: 한 프로세스의 자원 독점으로 다른 프로세스의 접근이 불가능하다.
* 점유 대기: 특정 프로세스가 점유한 자원을 다른 프로세스가 요청한 상태
* 비선점: 다른 프로세스의 자원을 강제로 가져올 수 없다.
* 환형 대기: 프로세스 A는 프로세스 B의 자원을 요구하고, 프로세스 B는 프로세스 A의 자원을 요청하는 상황

#### 교착상태의 해결 방법
1. 자원 할당 시 원인이 제공되지 않게 설계한다.
2. 교착상태 가능성이 없을때만 자원을 할당하고, 프로세스당 요청할 자원들의 최대치를 통해 자원 할당 가능 여부를 파악하는 **은행원 알고리즘**을 사용한다.
3. 교착 상태가 발생하면 사이클이 있는지 찾고, 관련된 프로세스를 하나씩 지운다.

* 은행원 알고리즘 : 총 자원의 양과 현재 할당한 자원의 야을 기준으로 안정 또는 불안정 상태로 나누고 안정 상태로 가도록 자원을 할당하는 알고리즘
    