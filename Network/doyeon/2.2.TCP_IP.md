## TCP/IP 4계층 모델

인터넷 프로토콜 스위트는 인터넷에서 컴퓨터들의 정보를 주고 받는데 사용되는 프로토콜의 집합을 의미한다.<br>
인터넷 프로토콜을 나타내는데, <u>TCP/IP 4계층 모델과 OSI 7계층 모델</u>이 있다.
<br>

- TCP/IP 4계층 <br>
애플리케이션계층 - 전송계층 - 인터넷계층 - 링크계층
<br>

- OSI 7계층 <br>
애플리케이션계층 - 프레젠테이션계층 - 세션계층 - 전송계층 - 네트워크계층 - 데이터링크계층 - 물리계층
<br>

계층들은 특정 계층이 변경되어을 때 다른 계층에는 영향을 미치지 않게 설계되었다. <br>
예를 들어 전송계층에서 TCP를 사용하다가 UDP를 사용한다고 해서,<br> 
위의 계층의 애플리케이션계층 또는 아래의 인터넷계층에 영향을 미치지 않는다는 것이다.

<br>
<br>

### 1.애플리케이션 계층
FTP, HTTP, SSH, SMTP, DNS등의 다양한 응용프로그램이 사용되어지는 프로토콜 계층이다.<br>
실질적으로 사람들에게 서비스를 제공하는 계층이다.

<br>
<br>
<br>

### 2.전송계층
송신자와 수신자를 연결하는 통신 서비스를 제공한다. 연결지향형이며, 신뢰성을 제공한다. <br>
인터넷계층과 애플리케이션계층의 중계자 역할을 한다. TCP/UDP가 대표적으로 있다. <br>
TCP는 패킷의 순서를 보장하고 연결지향 프로토콜이며 신뢰성을 보장한다. 가상회선 패킷 교환방식이다.<br>
UDP는 순서를 보장하지 않으며 수신여부를 확인하지 않기 때문에 비신뢰성이다. 데이터그램 패킷 교환방식이다.

<br>

>#### 가상회선 패킷 교환방식이란 전송계층의 PDU단위가 패킷이고, 송신부에서 수신부로 이동시 순서를 가지고 전송되며, 도착하는 것 역시 순서대로 도착한다.

>#### 데이터그램패킷 교환방식이란 전송계층의 PDU단위가 데이터그램이고, 송신부에서 수신부로 이동시 순서를 가지지 않고 전송되며, 도착하는 것 역시 순서에 상관없이 도착한다.

<br>
<br>

#### 3-웨이 핸드셰이크
TCP는 신뢰성있는 프로토콜이라고 설명했다. 신뢰성을 확보하기 위한 방법으로 3-웨이 핸드셰이크를 이용한다.
- SYN단계 <br>
syhchroniazation의 약자로 연결 요청 플래그이다.
먼저 클라이언트가 서버에 자신의 ISN과 함께 SYN을 보낸다.
- SYN + ACK단계  
서버는 클라이언트의 ISN에 +1을 하고, 자신의 ISN과 함께 SYN을 보낸다.

- ACK단계
클라이언트는 서버의 ISN +1을 하고, ACK에 담아 보낸다. 이후 데이터 전송이 시작된다.<br>
TCP는 위의 단계를 거치기 때문에 신뢰성 있는 연결이라고 한다.

<br>

#### 4-웨이 핸드셰이크
TCP가 연결을 해제할 때 4-웨이 핸드셰이크가 발생한다.
클라이언트가 서버에 FIN을 보낸다. 그리고 서버에서는 그에 대한 응답을 하고 잠 시뒤 자신의 FIN을 보낸다. 
클라언트는 ACK한 후 잠시의 시간을 가지고서 연결이 끊게 된다.


<br>
<br>
<br>

### 3.인터넷계층

장치로 부터 받은 네트워크 패킷을 IP주소를 이용해서 지정된 목적지로 전송하기 위해서 사용되는 계층이다.<br>
IP, ARP, ICMP등이 있다. 상대방이 데이터를 제대로 받았는지 보장하지 않는 비연결형적인 특성이 있다.

<br>
<br>
<br>

### 4.링크계층
실질적으로 데이터를 전달하며 장치간의 신호를 주고 받는 규칙을 정하는 계층이다.
물리계층과 데이터링크계층으로 나뉘기도 한다. <br>
물리계층은 무선LAN, 유선LAN을 통해 데이터를 보내는 계층을 말한다. <br>
데이터링크계층은 이더넷 프레임을 통해 에러확인, 흐름제어, 접근제어를 담당하는 계층을 말한다. <br>

<br>
<br>

#### 전이중화 통신
유선 LAN의 경우 전이중화 통신을 이용한다. 양쪽의 장치가 동시에 송수신 할 수 있는 것을 말한다.

<br>

#### CSMA/CD
이전 유선 LAN은 반이중화 통신 중 하나인, CSMA/CD를 이용했다.<br>
이 방식을 사용시 데이터 전송시 충돌이 발생할 수 있다.
충돌이 발생하면, 일정시간 이후 다시 재전송을 한다.

<br>

#### CSMA/CA
무선 LAN이 사용하는 반이중화 통신 중 하나이다. 양쪽이 서로 통신을 할 수 있지만, 동시에는 불가능한 방법이다.<br>
통신 중 하나의 장치에서 데이터를 보내기 전에 사전에 데이터 충동 가능성을 탐지해서 방지하는 시스템이다.

<br>
<br>
<br>

### 계층간 데이터 송수신 과정
A가 B에 데이터를 요청하면, 그 과정은 앞서 설명한 TCP/IP 4계층을 지나면서 캡슐화 되고, 다시 비캡슐화를 하면서 데이터가 전송된다.

>#### 캡슐화란 상위계층에서 하위계층으로 이동하면서, 상위계층의 데이터와 헤더를 하위계층의 데이터와 헤더에 포함시키는 과정이다.
>#### 비캡슐화는 하위계층에서 상위계층으로 이동하면서, 캡슐화와 반대로 동작하는 과정이다.

<br>
<br>
<br>

### PDU
계층에서 계층으로 데이터가 전달 될 때, 데이터의 단위를 PDU라고 말한다. 각 계층별로 불리는 방법이 다르다<br>
- 애플리케이션계층  
메시지
- 전송계층<br> 
세그먼트(TCP), 데이터그램(UDP)

- 인터넷계층<br> 
패킷
- 링크계층<br> 
프레임(데이터 링크계층), 비트(물리 계층)
