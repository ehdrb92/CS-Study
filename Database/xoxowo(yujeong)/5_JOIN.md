## 조인 (JOIN)
    하나의 테이블이 아닌 **두개 이상의 테이블을 묶어서** 하나의 결과물로 만드는 것.
    MySQL에서는 JOIN이라는 쿼리로 MongoDB에서는 lookup이라는 쿼리로 처리한다.

* 참고로 MongoDB는 성능이 떨어지기 때문에 lookup을 되도록 지양해야한다. 그래서 여러 테이블을 JOIN하는 작업이 많을 수록 관계형데이터베이스를 사용해야한다.

### 조인의 종류
    조인은 두 개 이상의 테이블을 묶어 하나의 결과물로 만드는 것이기 때문에 여러가지 조인이 있는데, 
    대표적으로 내부조인, 왼쪽 조인, 오른쪽 조인, 합집합 조인이 있다.

<img src="https://i.ibb.co/0skHY82/2022-02-24-6-58-10.png">

#### 내부조인 (inner join)
    내부 조인은 두 테이블 간의 **교집합**을 나타낸다.


```SQL
SELECT * FROM TableA A
INNER JOIN TableB B ON
A.key = B.key
```


#### 왼쪽 조인 (left outer join)
    왼쪽 조인은 테이블 B의 일치하는 부분의 레코드와 함께 테이블 A를 기준으로 완전한 코드 집합을 생성한다.
    만약 테이블 B에 일치하는 항목이 없으면 해당 값은 null 값이 된다.


```SQL
SELECT * FROM TableA A
LEFT JOIN TableB B ON
A.key = B.key
```

#### 오른쪽 조인 (right outer join)
    오른쪽 조인은 테이블 A에서 일치하는 부분의 레코드와 함께 테이블 B를 기준으로 완전한 레코드 집합을 생성한다.
    만약 테이블 A에 일치하는 항목이 없으면 해당 값은 null 값이 된다.

    (오른쪽 조인의 반대 모양이라고 생각하면 쉽다.)


```SQL
SELECT * FROM TableA A
RIGHT JOIN TableB B ON
A.key = B.key
```


#### 합집합 조인 (full outer join)
    합집합 조인 (완전 외부 조인)은 양쪽 테이블에서 일치하는 레코드와 함께 테이블 A와 테이블 B의 모든 레코드 집합을 생성한다.
    이때 일치하는 항목이 없으면 누락된 쪽에 null 값이 포함되어 출력된다.


```SQL
SELECT * FROM TableA A
FULL OUTER JOIN TableB B ON
A.key = B.key
```

## 조인의 원리
    조인의 원리를 기반으로 조인 작업이 이뤄지며, 조인의 원리는 중첩 루프 조인, 정렬 병합 조인, 해시 조인이 있다.

### 중첩 루프 조인
    중첩 루프 조인은 중첩 for문과 같은 원리로 조건에 맞는 조인을 하는 방법.
    랜덤 접근에 대한 비용이 많이 증가하기 때문에 대용량의 테이블에서는 사용하지 않는다.

    * 참고로 작은 블록으로 나눠 블록 하나씩 조인하는 **블록 중첩 루프 조인**이라는 방식도 있다.

### 정렬 병합 조인
    정렬 병합 조인은 각각의 테이블을 조인할 필드 기준으로 정렬하고 정렬이 끝난 이후에 조인작업을 수행하는 조인이다.
    조인할 때 쓸 적절한 인덱스가 없고 대용량의 테이블들을 조인하고 조인 조건으로 <.> 등 범위 비교 연산자가 있을 때 사용한다.


### 해시 조인
    해시 테이블을 기반으로 조인하는 방법.
    두 개의 테이블을 조인한다고 가정할 때 하나의 테이블이 메모리에 온전히 들어간다면 보통 중첩 루프 조인보다 더 효율적

    MySQL는 8.0.18 릴리스와 이 기능을 사용할 수 있게 되었고

    MySQL의 해시 조인 단계는 **빌드단계**, **프로브 단계**로 나뉜다.

#### 빌드 단계
    빌드 단계는 입력 테이블 중 하나를 기반으로 메모리 내 해시 테이블을 빌드하는 단계.
    조인에 사용되는 필드가 해시 테이블의 키로 사용된다.


<img src="https://hoing.io/storage/2021/01/build-phase-1.jpg">
-이미지 출처 https://hoing.io/archives/14457

#### 프로브 단계
    프로브 단계 동안 레코드 읽기를 시작하며, 각 레코드에서 일치하는 레코드를 찾아 결괏값buff으로 반환한다.

    테이블은 한 번씩만 읽게 되어 중첩해서 읽는 중첩 루프 조인보다 보통 성능이 좋다.

    * 참고로 사용 가능한 메모리양은 시스템 변수 join_butter_size에 의해 제어되며, 런타임 시에 조정 할 수 있다.

<img src="https://hoing.io/storage/2021/01/probe-phase-1.jpg">
-이미지 출처 https://hoing.io/archives/14457





